## Exploring OpenShift

In this lab you will get familiar with OpenShift Web Console and OpenShift CLI and gain some interactive experience with an OpenShift cluster.

#### The OpenShift CLI
OpenShift ships with a feature rich web console as well as command line tools
to provide users with a nice interface to work with applications deployed to the
platform.  The OpenShift tools are a single executable written in the Go
programming language and is available for the following operating systems:

- Microsoft Windows
- Apple OS X
- Linux

As we will be working with the web console and the CLI throught this workshop, 
the first thing we want to do is to install the Openshift CLI tools and ensure that the `oc` command line tool was installed and successfully added to your path. 

#### Downloading the tools
During this lab, we are going to download the client tool and add them to our
operating system $PATH environment variables so the executable is accessible
from any directory on the command line.

The first thing we want to do is download the correct executable for your
operating system as linked below:

- {{DOWNLOAD_CLIENT_WINDOWS}}[Microsoft Windows]
- {{DOWNLOAD_CLIENT_MAC}}[Apple OS X]
- {{DOWNLOAD_CLIENT_LIN64}}[Linux 64]
{% if DOWNLOAD_CLIENT_LIN32.empty? %}
- {{DOWNLOAD_CLIENT_LIN32}}[Linux 32]
{% endif %}

Once the file has been downloaded, you will need to extract the contents as it
is a compressed archive.  I would suggest saving this file to the following
directories:

**Windows:**

[source,bash]
----
C:\OpenShift
----

**OS X:**

[source,bash]
----
~/OpenShift
----

**Linux:**

[source,bash]
----
~/OpenShift
----

#### Extracting the tools
Once you have the tools downloaded, you will need to extract the contents:

**Windows:**

In order to extract a zip archive on Windows, you will need a zip utility
installed on your system.  With newer versions of Windows (greater than XP),
this is provided by the operating system.  Just right click on the downloaded
file using file explorer and select to extract the contents.

**OS X:**

Open up a terminal window and change to the directory where you downloaded the
file.  Once you are in the directory, enter in the following command:

[source,bash,role=copypaste]
----
$ unzip oc-macosx.tar.gz
----

NOTE: The zip file name needs to be replaced by the entire name that was downloaded in the previous step.

**Linux:**

Open up a terminal window and change to the directory where you downloaded the
file.  Once you are in the directory, enter in the following command:

[source,bash,role=copypaste]
----
$ tar zxvf oc-linux.tar.gz
----

NOTE: The tar.gz file name needs to be replaced by the entire name that was downloaded in the previous step.


#### Adding `oc` to your PATH

**Windows:**

Because changing your PATH on Windows varies by version of the operating system,
we will not list each operating system here.  However, the general workflow is
right click on your computer name inside of the file explorer.  Select Advanced
system settings. I guess changing your PATH is considered an advanced task? :)
Click on the advanced tab, and then finally click on Environment variables.
Once the new dialog opens, select the Path variable and add ";C:\OpenShift" at
the end.  For an easy way out, you could always just copy it to C:\Windows or a
directory you know is already on your path. For more detailed instructions:

https://support.microsoft.com/en-us/kb/310519[Windows XP]

http://banagale.com/changing-your-system-path-in-windows-vista.htm[Windows Vista]

http://geekswithblogs.net/renso/archive/2009/10/21/how-to-set-the-windows-path-in-windows-7.aspx[Windows 7]

http://www.itechtics.com/customize-windows-environment-variables/[Windows 8]

Windows 10 - Follow the directions above.

**OS X:**

[source,bash]
----
$ export PATH=$PATH:~/OpenShift
----

**Linux:**

[source,bash]
----
$ export PATH=$PATH:~/OpenShift
----

#### Working with proxies
It might happen that you're behind a corporate proxy to access the internet. In this case, you'll need to set
some additional environment variables for the oc command line to work.

**Windows:**
Follow previous section's instructions on how to set an Environment Variable on Windows. The variables you'll need
to set are:

[source,bash]
----
https_proxy=http://proxy-server.mycorp.com:3128/
HTTPS_PROXY=http://proxy-server.mycorp.com:3128/
----

**OS X:**

[source,bash]
----
$ export https_proxy=http://proxy-server.mycorp.com:3128/
$ export HTTPS_PROXY=http://proxy-server.mycorp.com:3128/
----

**Linux:**

[source,bash]
----
$ export https_proxy=http://proxy-server.mycorp.com:3128/
$ export HTTPS_PROXY=http://proxy-server.mycorp.com:3128/
----

[NOTE]
====
If the proxy is secured, make sure to use the following URL pattern, replacing the contents with the
appropriate values:

export https_proxy=http://USERNAME:PASSOWRD@proxy-server.mycorp.com:3128/

__Special Characters__: If your password contains special characters, you must replace them with ASCII codes, for example the at sign @ must be replaced by the %40 code, e.g. p@ssword = p%40ssword. 
====


#### Verify
At this point, we should have the oc tool available for use.  Let's test this
out by printing the version of the oc command:

[source,bash]
----
$ oc version
----

You should see the following (or something similar):

[source,bash]
----
{{OC_VERSION}}
----

If you get an error message, you have not updated your path correctly.  If you
need help, raise your hand and the instructor will assist.

#### Exploring the CLI

In order to login, you can use the `oc` command and then specify the server that you want to authenticate to. Issue the following command:

[source,shell]
----
$ oc login {{OPENSHIFT_URL}}
----

Enter *Y* to use a potentially insecure connection. The reason you received this message is because we are using a self-signed certificate for this workshop, but we did not provide you with the CA certificate that was generated by OpenShift. In a real-world scenario, either OpenShift certificate would be signed by a standard CA (eg: Thawte, Verisign, StartSSL, etc.) or signed by a corporate-standard CA that you already have installed on your system.

Once you issue the `oc login` command, you will be prompted for the username and password combination for your user account. Replace XX with the username given to you by the instructor:

CAUTION: Replace `{{PROJECT_SUFFIX}}` with the number provided to you by the instructor.

* Username: `{{OPENSHIFT_USER}}`
* Password: `{{OPENSHIFT_PASSWORD}}`

Projects are a top level concept to help you organize your deployments. An OpenShift project allows a community of users (or a user) to organize and manage their content in isolation from other communities. Each project has its own resources, policies (who can or cannot perform actions), and constraints (quotas and limits on resources, etc). Projects act as a "wrapper" around all the application services and endpoints you (or your teams) are using for your work. You can see the list of projects you have access to using the following command:

[source,shell]
----
$ oc get projects
----

Now you can create a project:

CAUTION: Replace `{{PROJECT_SUFFIX}}` with the number provided to you by the instructor.

[source,shell]
----
$ oc new-project explore-{{PROJECT_SUFFIX}}
----

When using OpenShift CLI, you can specify in which project the command should be executed using the `-n` switch. If not specified, OpenShift will run the command in the active project. You can switch between active projects using the `oc project` command:

CAUTION: Replace `{{PROJECT_SUFFIX}}` with the number provided to you by the instructor.

[source,shell]
----
$ oc project explore-{{PROJECT_SUFFIX}}

Now using project "explore-{{PROJECT_SUFFIX}}" on server "{{OPENSHIFT_URL}}".
----

#### OpenShift Web Console

OpenShift ships with a web-based console that will allow users to perform various tasks via a browser. To get a feel for how the web console works, open your browser and go to the following URL: {{OPENSHIFT_URL}}

Since the security certificates used for securing your OpenShift cluster are self-generated and self-signed, your browser will not trust them by default and will show a security warning similar to the following:

image::devops-explore-cert-warning-firefox.png[Firebox Untrusted Certificate]

In Chrome browser, click on *ADVANCED* and then *Proceed to ... (unsafe)* to trust the certificates. In Firefox browser, click on *Advanced* button, then *Add Exception...* and then confirm trusting the certificate by click on *Confirm Security Exception*.

The first screen you will see is the authentication screen. Enter in the following credentials:

CAUTION: Replace `{{PROJECT_SUFFIX}}` with the number provided to you by the instructor.

* Username: `{{OPENSHIFT_USER}}`
* Password: `{{OPENSHIFT_PASSWORD}}`

image::devops-explore-web-login.png[OpenShift Login]

After you have authenticated to the web console, you will be presented with a list of projects that your user has permission to work with.

When you click on the *explore-{{PROJECT_SUFFIX}}* project, you will be taken to the project overview page which will list all of the routes, services, deployments, and pods that you have running as part of your project. There’s nothing there now, but in the following labs you will create deployments and other resources in your projects.

You can delete a project (and other resources) using the `oc delete` command. You won’t need the *explore-{{PROJECT_SUFFIX}}* project in the following labs and therefore you can clean up your environment by removing it:

CAUTION: Replace `{{PROJECT_SUFFIX}}` with the number provided to you by the instructor.

[source,shell]
----
$ oc delete project explore-{{PROJECT_SUFFIX}}
----
